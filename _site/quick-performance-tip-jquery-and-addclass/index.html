<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>Quick Performance Tip: jQuery <span class="widow">and addClass</span>—zachleat.com</title>
		<link href="/atom.xml" rel="alternate" title="Web 367 via zachleat.com" type="application/atom+xml">

		<link href="/web/css/global.css" rel="stylesheet">
	</head>
	<body>
		<div class="rail">
			<header>
				<a href="/web/">
					<h1>Web 3.0, 6 Bladed Razors, 7 Minute Abs</h1>
				</a>
				<h2>A bunch of words by zachleat.</h2>
			</header>
			<aside>
				<nav role="navigation">
				</nav>
			</aside>
		</div>
		<div class="content">
			<div class="main" data-role="main">
				<article>
<h1>Quick Performance Tip: jQuery <span class="widow">and addClass</span></h1>
<em>Posted on 30 Jun 2009</em>
<h1></h1>

<p>Abstractions are helpful and dangerous. But the more we know about a library’s internals, the less danger we’ll be in later. Here’s an issue I ran into where I had assumed that jQuery would be optimized for this case, but it wasn’t. I’ll go over my bad assumption and how to workaround it.</p>

<p>As of jQuery 1.3.2, adding multiple HTML classes to an element using jQuery’s addClass method will add them one at a time, modifying the className property of an element for each class.</p>

<pre><code>$&amp;#40;'#myElement'&amp;#41;.addClass&amp;#40;'myFirstClass mySecondClass'&amp;#41;;
</code></pre>

<p>Here’s the original code inside of jQuery 1.3.2. Note how the classNames string is split, and elem.className is changed for each split entry.</p>

<pre><code>add: function&amp;#40; elem, classNames &amp;#41; &amp;#123;
    jQuery.each&amp;#40;&amp;#40;classNames || ""&amp;#41;.split&amp;#40;/s /&amp;#41;, function&amp;#40;i, className&amp;#41;&amp;#123;
        if &amp;#40; elem.nodeType == 1 &amp;&amp; !jQuery.className.has&amp;#40; elem.className, className &amp;#41; &amp;#41;
            elem.className  = &amp;#40;elem.className ? " " : ""&amp;#41;   className;
        &amp;#125;&amp;#41;;
    &amp;#125;,
// ...
</code></pre>

<p>This may cause longer than needed delays, as reflow may occur after every class is added individually. If absolutely necessary, you can always fall back to modifying the className yourself, like so:</p>

<pre><code>$&amp;#40;'#myElement'&amp;#41;.each&amp;#40;function&amp;#40;&amp;#41;
&amp;#123;
   this.className  = ' myFirstClass mySecondClass';
&amp;#125;&amp;#41;;
</code></pre>

<p>Most likely, this isn’t a tip that will be needed, but it is useful to be aware of.</p>

</article>
			</div><!-- /.main -->
		</div><!-- /.content -->
		<script type="text/javascript">
		// var _gaq = _gaq || [];
		// _gaq.push(['_setAccount', '']);
		// _gaq.push(['_trackPageview']);

		// (function() {
		// 	var ga = document.createElement('script');
		// 	ga.type = 'text/javascript';
		// 	ga.async = true;
		// 	ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		// 	var s = document.getElementsByTagName('script')[0];
		// 	s.parentNode.insertBefore(ga, s);
		// })();
		</script>
	</body>
</html>